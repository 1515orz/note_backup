# 流程控制


## 单分支 IF 语句

    IF语句类似于 [ 判断命令 ] && echo yes || echo no
    
> 单分支if条件语句

```
if [ 条件判断式 ];then # if和then放在一起需要号分隔
    main
if

# 或者这样写
if [ 条件判断式 ]
    then
        main
if
```

* 单分支条件语句需要注意的几个点
> if语句使用fi结尾, 和一般语言使用大括号结尾不同
>` [ 条件判断式 ]`就是使用`test`命令判断, 所以中括号和条件判断式之间必须有空格
> then后面根符合条件之后执行的程序, 可以放在[]之后, 用`;`分隔, 也可以换行写入, 就不用`;`了

### IF 例子

统计根分区使用率
```
# 把根分区使用率作为变量赋予变量rate
rate=$(df -h | grep "dev/sda1" | awk '{print $5}' | cut -d "%" -f1)

# 如果超过阈值则报警
if [ $rate -ge 80 ]
        then
            echo "Warning /dev/sda1 is full!!"
fi

```
> 定时命令
> 将需要重复执行的行为写入脚本, 定时执行, 省下大多数工作量

## 双分支 IF 条件语句

```
if [ 条件判断式 ]
    then
        main1
    else
        main2
if
```

### 双分支例子

```
#!/bin/bash

date=$(date +%y%m%d) # 赋值date变量
size=$(du -sh /etc)  # 赋值size变量

if [ -d /tmp/dbback ] # 如果文件夹存在
        then
                echo "Date is : $date" > /tmp/dbback/db.txt
                echo "Size is : #size" >> /tmp/dbback/db.txt
                cd /tmp/dbback
                # 将/etc目录和db.txt打包到一起
                tar -zcf etc_$date.tar.gz /etc db.txt &>/dev/null
                rm -rf /tmp/dbback/db.txt  # 删除打包之前的文件
        else  # 假如不存在/tmp/dbback这个目录
                mkdir /tmp/dbback/db/txt
                # 下面的步骤和上面相同
                echo "Date is : $date" > /tmp/dbback/db.txt
                echo "Size is : #size" >> /tmp/dbback/db.txt
                cd /tmp/dbback
                tar -zcf etc_$date.tar.gz /etc db.txt &>/dev/null
                rm -rf /tmp/dbback/db.txt
fi
```
* 定义date变量`date=$(date +%y%m%d)`作为"年月日"的数字格式
* 为新文件命名时, 增加$date的标识字, 可以避免覆盖操作
